<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONCHING</title>
    <link rel="icon" type="image/svg+xml" href="Image/logo.png">

    <!-- Bootstrap CSS 했음-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"/>
    <link rel="stylesheet" href="./css/style.css">

    <!-- jquery 했음 -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js" crossorigin="anonymous"></script>
    <script src="./js/jscript.js"></script>

    <!-- ipfs 했음-->
    <script src="./js/buffer.js"></script>
    <script src="https://unpkg.com/ipfs-api/dist/index.js" crossorigin="anonymous"></script>
    <script>
        function updateFileName() {
            var fileInput = document.getElementById('uploadfile');
            var fileDisplayArea = document.getElementById('file-display');

            // Check if any file is selected
            if (fileInput.files.length > 0) {
                var fileName = fileInput.files[0].name;
                fileDisplayArea.value = fileName;
            }
        }
    </script>

    <!-- blockchain-->
    <script type="text/javascript" src='./js/abi.js'></script>
    <script type="text/javascript" src='./js/web3.min.js'></script>
    <script>
        $(window).load(async function () {

        });

    </script>
    <!-- Contracts.mjs-->
    <script src="js/abj.js"></script>

    <script>
        $(document).ready(function () {
            // 메타마스크 연결 및 초기화 함수
            async function initializeMetaMask() {
                // 메타마스크 설치 여부 확인

                if (typeof window.ethereum !== "undefined") {
                    console.log("메타마스크가 설치되었습니다.");
                    try {
                        // 메타마스크 연결 요청
                        $("#resultbrowsers").text("메타마스크 연결하세요!");
                        const accounts = await ethereum.request({method: "eth_requestAccounts"});
                        $("#showAccount").text(accounts[0]);
                        $("#resultbrowsers").html("<span id='checkmark'>✔</span> 메타마스크에 연결되었습니다.").addClass('green-alert');
                        // 3초 뒤에 알림 숨기기
                        setTimeout(function () {
                            $("#resultbrowsers").fadeOut();
                        }, 3000);

                        // Web3 인스턴스 생성
                        window.web3 = new Web3(window.ethereum);
                        // 필요한 경우 여기에 블록체인 인터렉티브 코드를 추가한다.
                    } catch (error) {
                        console.log(`에러: ${error}`);
                        $("#resultbrowsers").html("<span id='checkmark'>x</span> 메타마스크 연결에 실패했습니다.").addClass('orange-alert');
                    }
                } else {
                    $("#resultbrowsers").html("<span id='checkmark'>x</span> 메타마스크가 설치되어 있지 않습니다.").addClass('orange-alert');
                }
            }

            //함수 메타마스크 호출
            initializeMetaMask();
        });
    </script>
</head>
<body>
<header>
    <!-- Fixed navbar -->

    <nav aria-label="Eighth navbar example" class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="Image/logo.png" alt="Logo" style="height: 40px; margin-right: 5px;">CONCHING
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarsExample07"
                    aria-controls="navbarsExample07" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarsExample07">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="index.html"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mynft.html">조회</a>
                    </li>
                    <li class="nav-my favorite">
                        <a class="nav-link" href="mygift.html"><b style="color: white;">Gifticon</b></a>
                    </li>
                </ul>

                <div class="d-flex justify-content-end">
                    <button type="button" class="btn btn-warning" id="btn_setApprovalForAll">거래하기</button>
                    <script>
                        document.getElementById('btn_setApprovalForAll').addEventListener('click', function () {
                            window.location.href = 'https://chidokun.github.io/p2p-file-transfer/';
                        });
                    </script>
                </div>
            </div>
        </div>
    </nav>
</header>
</header>

</header>
</body>
</html>